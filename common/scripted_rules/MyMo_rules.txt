##replacing vanilla entry
is_character_allowed_to_be_player = {
	custom_description = {
		text = "GAME_OVER_CANNOT_PLAY_THEOCRACY"
		NOT = { has_government = theocracy_government }
	}

	##mymo
	custom_description = {
		text = "GAME_OVER_CANNOT_PLAY_THEOCRACY"
		NOT = {	has_government = monastic_government }
	##
}


# Can the character join the defender in a holy war? Only characters' of the defender's faith are considered. Player characters are not considered.
# Scope is the potential joiner
# scope:attacker is the attacker
# scope:defender is the defender
can_defensively_join_holy_war = {
	is_landed = yes
	exists = scope:defender.capital_province
	exists = capital_province
	gold >= ai_war_chest_defender_holy_war_gold_value
	is_at_war = no
	NOR = {
		is_vassal_or_below_of = scope:defender
		is_allied_to = scope:attacker
		has_relation_friend = scope:attacker
		has_relation_lover = scope:attacker
		has_trait = craven
		has_relation_rival = scope:defender
	}
	OR = {
		primary_title.tier >= tier_duchy # Of significant size
		current_military_strength >= scope:defender.current_military_strength # Avoid having too many small counts join in
	}
	OR = {
		AND = { #If it's a struggle clash, are they in Iberia?
			scope:defender = {
				any_character_war = {
					primary_defender = scope:defender
					primary_attacker = scope:attacker
					using_cb = county_struggle_cb
				}
			}
			AND = { # Unless very zealous or friendly, within a reasonable distance
				OR = {
					ai_zeal >= 40
					has_relation_friend = scope:defender
					has_relation_lover = scope:defender
					is_close_family_of = scope:defender
				}
				capital_province = {
					OR = {
						geographical_region = world_europe_west_iberia
						geographical_region = custom_maghreb_struggle
					}
				}
			}
		}
		AND = {
			character_is_realm_neighbor = scope:defender # Needs to be an independent realm neighbour
			AND = { # Unless very zealous or friendly, within a reasonable distance
				OR = {
					ai_zeal >= 75
					has_relation_friend = scope:defender
					has_relation_lover = scope:defender
					is_close_family_of = scope:defender
				}
				capital_province = {
					squared_distance = {
						target = scope:defender.capital_province
						value <= squared_distance_medium #250 map-pixels. Roughly one Ireland away (top to bottom).
					}
				}
			}
		}
	}
}
