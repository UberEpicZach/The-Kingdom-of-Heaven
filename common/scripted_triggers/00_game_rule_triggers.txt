hungarian_migration_valid_ai_mogyer_ruler_trigger = {
	culture = culture:mogyer
	is_ai = yes
	government_has_flag = government_is_tribal
	is_at_war = no
	highest_held_title_tier <= tier_kingdom
	OR = {
		is_independent_ruler = yes
		NOT = {
			liege = { culture = culture:mogyer }
		}
	}
}

hungarian_migration_valid_pannonian_target_trigger = {
	NOR = {
		culture = culture:mogyer
		any_liege_or_above = { culture = culture:mogyer }
	}
	is_ai = yes
	any_realm_county = {
		count >= $COUNT$
		title_province = { geographical_region = custom_hungary }
	}
}

exclave_independence_trigger = {
	is_independent_ruler = yes
	NOT = { has_title = title:k_papal_state has_title = title:d_hashshashin top_liege = { has_title = title:d_hashshashin }}
	exists = root.capital_province
	any_sub_realm_title = {
		tier = tier_county
		NOT = {
			is_connected_to = {
				target = root.capital_province.county
			}
		}
	}
	trigger_if = {
		limit = {
			exists = primary_heir
		}
		primary_heir = {
			NOR = {
				is_independent_ruler = yes # Disallow this when the heir is independent, lest we risk breaking up realms that should be connected
				is_ai = no # Players always inherit everything
			}
		}
	}
}

# Sometimes we disable these events for specific characters.
harm_game_rule_enablement_trigger = {
	# Disable entirely if random harm is set to safe.
	NOT = { has_game_rule = harm_safe }
	# Player vs. AI targeting.
	NOR = {
		# Players.
		AND = {
			has_game_rule = harm_target_player_only
			is_ai = no
		}
		# The AI.
		AND = {
			has_game_rule = harm_target_ai_only
			is_ai = yes
		}
		# And never just kill the player if it'd utterly game-over them.
		AND = {
			is_ai = no
			OR = {
				# Either because they have no heir.
				NOT = { exists = player_heir }
				# Or because they have an heir they can't survive with.
				AND = {
					exists = player_heir
					NOT = { dynasty = player_heir.dynasty }
				}
			}
		}
	}
}

# Who do we care about when recording variable logs for harm events?
harm_game_rule_valid_for_logging_trigger = {
	OR = {
		AND = {
			highest_held_title_tier >= tier_duchy
			OR = {
				government_has_flag = government_is_feudal
				government_has_flag = government_is_clan
				government_has_flag = government_is_theocracy
			}
		}
		any_close_family_member = {
			highest_held_title_tier >= tier_duchy
			OR = {
				government_has_flag = government_is_feudal
				government_has_flag = government_is_clan
				government_has_flag = government_is_theocracy
			}
		}
	}
}
